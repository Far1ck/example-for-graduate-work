package ru.skypro.homework.dto;

import jakarta.validation.constraints.Size;
import lombok.Data;

/**
 * Data Transfer Object (DTO) для смены пароля пользователя.
 *
 * <p>Используется в API для приёма и валидации данных при изменении пароля учётной записи.
 * Содержит два поля: текущий пароль (для подтверждения личности) и новый пароль
 * (для установки).
 *
 * <p>Основные особенности:
 * <ul>
 *   <li>применяет валидационные ограничения через аннотации Jakarta Validation;</li>
 *   <li>использует Lombok для генерации стандартного кода;</li>
 *   <li>не включает идентификаторы пользователя — они передаются отдельно (например, через JWT).</li>
 * </ul>
 *
 * @see Data
 * @see jakarta.validation.constraints.Size
 */
@Data
public class NewPassword {

    /**
     * Текущий пароль пользователя для подтверждения права на смену пароля.
     *
     * <p>Применяются ограничения валидации:
     * <ul>
     *   <li>{@code min = 8} — минимальная длина 8 символов;</li>
     *   <li>{@code max = 16} — максимальная длина 16 символов.</li>
     * </ul>
     *
     * <p>Пароль передаётся в открытом виде только на уровне DTO. Перед сравнением
     * с сохранённым значением он будет хеширован и проверен через механизм аутентификации.
     *
     * <p>При несоответствии ограничениям будет выброшено исключение валидации
     * с сообщением о нарушении правил ввода.
     *
     * @see Size
     */
    @Size(min = 8, max = 16)
    private String currentPassword;

    /**
     * Новый пароль, который пользователь хочет установить.
     *
     * <p>Применяются те же ограничения валидации, что и для {@code currentPassword}:
     * <ul>
     *   <li>минимум 8 символов;</li>
     *   <li>максимум 16 символов.</li>
     * </ul>
     *
     * <p>Перед сохранением в хранилище пароль будет надёжно хеширован (например, с помощью BCrypt).
     *
     * <p>Валидация выполняется автоматически при обработке запроса Spring Validation.
     *
     * @see Size
     */
    @Size(min = 8, max = 16)
    private String newPassword;
}
