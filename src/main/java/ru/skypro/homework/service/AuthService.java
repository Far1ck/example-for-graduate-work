package ru.skypro.homework.service;

import ru.skypro.homework.dto.Register;

/**
 * Сервис для выполнения операций аутентификации и регистрации пользователей в системе.
 *
 * <p>Определяет базовый контракт для управления учётными записями, включая:
 * <ul>
 *   <li>проверку подлинности пользователя по логину и паролю;</li>
 *   <li>создание новой учётной записи с валидацией входных данных.</li>
 * </ul>
 *
 * <p><b>Примечание:</b> реализация сервиса должна обеспечивать:
 * <ul>
 *   <li>безопасное хранение паролей (с использованием хеширования, например BCrypt);</li>
 *   <li>уникальность логинов/email-адресов при регистрации;</li>
 *   <li>корректную обработку ошибок и исключений;</li>
 *   <li>соответствие требованиям политики безопасности системы.</li>
 * </ul>
 *
 * @see Register
 */
public interface AuthService {

    /**
     * Выполняет аутентификацию пользователя по указанным учётным данным.
     *
     * <p>Алгоритм работы:
     * <ol>
     *   <li>Получает имя пользователя и пароль в открытом виде.</li>
     *   <li>Находит запись пользователя в хранилище данных.</li>
     *   <li>Сравнивает предоставленный пароль с сохранённым (в зашифрованном виде).</li>
     *   <li>Возвращает результат проверки.</li>
     * </ol>
     *
     * <p><b>Требования к безопасности:</b>
     * <ul>
     *   <li>пароль никогда не должен храниться в открытом виде;</li>
     *   <li>сравнение должно выполняться через криптографический хеш (не прямое сравнение строк);</li>
     *   <li>необходимо предотвращать перебор паролей (например, через ограничение попыток).</li>
     * </ul>
     *
     * @param userName идентификатор пользователя (логин или email)
     * @param password пароль пользователя в исходном виде (до хеширования)
     * @return {@code true}, если аутентификация прошла успешно; {@code false} в случае ошибки
     *         (неверный пароль, пользователь не найден, технические проблемы)
     */
    boolean login(String userName, String password);

    /**
     * Регистрирует нового пользователя в системе.
     *
     * <p>Алгоритм работы:
     * <ol>
     *   <li>Принимает объект {@link Register} с полными данными пользователя.</li>
     *   <li>Выполняет валидацию всех полей (обязательные поля, форматы, уникальность).</li>
     *   <li>Хеширует пароль перед сохранением.</li>
     *   <li>Создаёт запись в хранилище данных.</li>
     *   <li>Возвращает статус операции.</li>
     * </ol>
     *
     * <p><b>Условия успешной регистрации:</b>
     * <ul>
     *   <li>все обязательные поля заполнены;</li>
     *   <li>логин/email не занят другим пользователем;</li>
     *   <li>пароль соответствует требованиям политики безопасности;</li>
     *   <li>данные успешно сохранены в хранилище.</li>
     * </ul>
     *
     * @param register объект DTO с данными нового пользователя ({@link Register})
     * @return {@code true}, если регистрация выполнена успешно; {@code false} если:
     *         <ul>
     *           <li>данные некорректны;</li>
     *           <li>пользователь с таким логином уже существует;</li>
     *           <li>возникла ошибка при сохранении данных.</li>
     *         </ul>
     * @see Register
     */
    boolean register(Register register);
}
